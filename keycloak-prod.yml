keycloak:
  container_name: keycloak
  image: jboss/keycloak:3.3.0.Final
  ports:
    - 9080:9080
    - 9443:9443
    - 10990:10990
  volumes:
    - ./realm-config:/opt/jboss/keycloak/realm-config
    - ./config/keycloak.env:/etc/secrets/keycloak.env
    - ./keycloack/:/opt/jboss/keycloak/themes/keycloack/
    - ./my-keycloak/:/opt/jboss/keycloak/themes/my-keycloak/
  environment:
      DB_VENDOR: "mysql"
      KEYCLOAK_ENVIRONMENT: "/etc/secrets/keycloak.env"
      KEYCLOAK_PASSWORD: "admin"
      KEYCLOAK_USER: "admin"
      MYSQL_PORT_3306_TCP_ADDR: "mariadb"
      MYSQL_PORT_3306_TCP_PORT: "3306"
      WAIT_ON_ADDR: "mariadb"
      WAIT_ON_PORT: "3306"
  command: ["-b", "0.0.0.0", "-Dkeycloak.migration.action=import", "-Dkeycloak.migration.provider=dir", "-Dkeycloak.migration.dir=/opt/jboss/keycloak/realm-config", "-Dkeycloak.migration.strategy=OVERWRITE_EXISTING", "-Djboss.socket.binding.port-offset=1000"]